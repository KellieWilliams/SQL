-- The following are example assessment questions from SQLZoo.net

--HelpDesk Questions
--1. There are three issues that include the words "index" and "Oracle". Find the call_date for each of them

SELECT Call_date, call_ref FROM issue
WHERE detail like '%index%' AND detail like '%Oracle%';

--2. Samantha Hall made three calls on 2017-08-14. Show the date and time for each

SELECT call_date, first_name, last_name
FROM issue i
LEFT JOIN caller c
ON i.caller_id = c.caller_id
WHERE call_date = '2017-08-14'
AND (first_name = 'Samantha' AND last_name = 'Hall');

--3. There are 500 calls in the system (roughly). Write a query that shows the number that have each status.

SELECT status, COUNT(Call_ref)
FROM issue
GROUP BY status;

--4. Calls are not normally assigned to a manager but it does happen. How many calls have been assigned to staff who are at Manager Level?

SELECT COUNT(i.Call_ref) AS Manager
FROM Issue i
JOIN staff s
ON i.assigned_to = s.staff_code
JOIN level l
ON s.level_code = l.level_code
WHERE l.Manager = 'Y';

--5. Show the manager for each shift. Your output should include the shift date and type; also the first and last name of the manager.

SELECT Shift_date, Shift_type, first_name, last_name
FROM Shift sh
JOIN Staff st
ON sh.Manager = st.staff_code;

--6. List the Company name and the number of calls for those companies with more than 18 calls.

SELECT Cu.Company_name, COUNT(i.Call_ref)
FROM Issue i
JOIN Caller Ca
ON i.Caller_id = Ca.Caller_id
JOIN Customer Cu
ON Ca.Company_ref = Cu.Company_ref
GROUP BY Cu.Company_name
HAVING COUNT(i.Call_ref) > 18;

--7. Find the callers who have never made a call. Show first name and last name

SELECT c.first_name, c.last_name
FROM Caller c
LEFT JOIN Issue i
ON c.Caller_id = i.Caller_id
WHERE i.call_date IS NULL
OR i.call_date = '';

